package com.skilldistillery.cards.blackjack;

import java.util.Scanner;

import com.skilldistillery.cards.players.Dealer;
import com.skilldistillery.cards.players.Player;
import com.skilldistillery.cards.players.UserPlayer;

public class GameDriver {

	public static void main(String[] args) {
		playGame();
	}

	public static void playGame() {
		Scanner kb = new Scanner(System.in);
		String entry = "";
		String dealerEntry = "";
		Dealer dealer = new Dealer();
		Player user = new UserPlayer();

		dealer.Shuffle();

		user.setHand(dealer.deal());
		dealer.setHand(dealer.deal());
		user.setHand(dealer.deal());
		dealer.setHand(dealer.deal());

		System.out.println("User hand: " + user.getHand().toString());
		System.out.println("Your current total: " + user.getTotal());
		System.out.println("Dealer's hand: " + dealer.getHand().toString());
		System.out.println("Dealer's current total: " + dealer.getTotal());
		
		// Game loop to determine if user has decided to stay
		inner1: do {

			System.out.println();
			System.out.println("Would you like to hit or stay?");
			entry = kb.next();
			if (!entry.equalsIgnoreCase("hit") && !entry.equalsIgnoreCase("stay")) {
				System.out.println("Please choose either hit or stay.");
			} else if (entry.equalsIgnoreCase("hit")) {
				user.setHand(dealer.hit());
				if (user.getTotal() > 21) {
					System.out.println("User hand: " + user.getHand().toString());
					System.out.println("Your current total: " + user.getTotal());
					System.out.println("You bust! IE YOU LOSE");
					break inner1;
				}
				System.out.println("User hand: " + user.getHand().toString());
				System.out.println("Your current total: " + user.getTotal());

			} else {
				System.out.println("You've decided to stay.");
				System.out.println("User hand: " + user.getHand().toString());
				System.out.println("Your current total: " + user.getTotal());
				System.out.println("Dealer's hand: " + dealer.getHand().toString());
				System.out.println("Dealer's current total: " + dealer.getTotal());

			}


		} while (entry.equalsIgnoreCase("hit"));

		inner2: do {
			dealerEntry = dealer.determineWhatToDo();

			if (entry.equals("hit")) {
				dealer.setHand(dealer.hit());
				if (dealer.getTotal() > 21) {
					System.out.println("Dealer busts - you win!");
					break inner2;
				}
				}
			
			System.out.println();
			System.out.println("Dealer decided to " + entry);
			System.out.println();
			System.out.println("User hand: " + user.getHand().toString());
			System.out.println("Your current total: " + user.getTotal());
			System.out.println("Dealer's hand: " + dealer.getHand().toString());
			System.out.println("Dealer's current total: " + dealer.getTotal());

			

		} while (dealerEntry.equals("hit"));
		

		if (user.getTotal() > dealer.getTotal()) {
			System.out.println("You win!");
		} else if (user.getTotal() < dealer.getTotal()) {
			System.out.println("Dealer wins.");
		} else {
			System.out.println("A draw...NOT A DRAW!!");
		}

		// PRINT OUT REMAINING CARDS IN DECK:
		// for (int i = 0; i < dealer.getDeck().getDeck().size(); i++){
		// System.out.println(dealer.getDeck().getDeck().get(i).toString());
		// }
	}
}
